<?xml version="1.0"?>
<!-- gpt4gen 0406 -->

<robot xmlns:xacro="http://www.ros.org/wiki/xacro">
  <xacro:macro name="gps_sensor" params="namespace parent_link *origin">
    <xacro:property name="sensor_name" value="gps" />

    <!-- <joint name="${namespace}/${sensor_name}_joint" type="fixed"> -->
    <joint name="${sensor_name}_joint" type="fixed">
      <xacro:insert_block name="origin" />
      <parent link="${parent_link}" />
      <!-- <child link="${namespace}/${sensor_name}_link" /> -->
      <child link="${sensor_name}_link" />
    </joint>



    <!-- <link name="${namespace}/${sensor_name}_link"> -->
    <link name="${sensor_name}_link">
       <visual>
      <geometry>
        <box size="0.1 0.1 0.025" />
      </geometry>
      <material name="white">
        <color rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <geometry>
        <sphere radius="0.05" />
      </geometry>
    </collision>
    <inertial>
      <mass value="0.1" />
      <origin xyz="0 0 0" rpy="0 0 0" />
      <inertia ixx="0.0002" ixy="0" ixz="0" iyy="0.0002" iyz="0" izz="0.0002" />
    </inertial>
    </link>

    <!-- <gazebo reference="${namespace}/${sensor_name}_link"> -->
    <!-- <gazebo reference="${sensor_name}_link"> -->
      <!-- <sensor type="gps" name="${namespace}/${sensor_name}"> -->

      <!-- <sensor type="gps" name="${sensor_name}">
        <always_on>true</always_on>
        <update_rate>20.0</update_rate>
        <gps>
          <position_sensing>
            <horizontal>
              <noise type="gaussian">
                <mean>0.0</mean>
                <stddev>1.0</stddev>
              </noise>
            </horizontal>
            <vertical>
              <noise type="gaussian">
                <mean>0.0</mean>
                <stddev>1.0</stddev>
              </noise>
            </vertical>
          </position_sensing>
          <velocity_sensing>
            <horizontal>
              <noise type="gaussian">
                <mean>0.0</mean>
                <stddev>0.1</stddev>
              </noise>
            </horizontal>
            <vertical>
              <noise type="gaussian">
                <mean>0.0</mean>
                <stddev>0.1</stddev>
              </noise>
            </vertical>
          </velocity_sensing>
        </gps>
        <plugin name="gazebo_ros_${sensor_name}_controller" filename="libhector_gazebo_ros_gps.so">
          <ros>
            <namespace>${namespace}</namespace>
            <gps_topic_name>gps/fix</gps_topic_name>
            <gps_velocity_topic_name>gps/fix_velocity</gps_velocity_topic_name>
          </ros>
        </plugin>
      </sensor>
    </gazebo>
     -->

    <plugin name="gps_controller" filename="libhector_gazebo_ros_gps.so">
    <alwayson>true</alwayson>
    <updaterate>8.0</updaterate>
    <bodyname>base_link</bodyname>
    <topicname>/fix</topicname>
    <velocitytopicname>/fix_velocity</velocitytopicname>
    <drift>5.0 5.0 5.0</drift>
    <gaussiannoise>0.1 0.1 0.1</gaussiannoise>
    <velocitydrift>0 0 0</velocitydrift>
    <velocitygaussiannoise>0.1 0.1 0.1</velocitygaussiannoise>
    </plugin>

  </xacro:macro>
</robot>